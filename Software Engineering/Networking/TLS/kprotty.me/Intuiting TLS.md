# [Intuiting TLS](https://kprotty.me/2025/04/01/intuiting-tls.html)

## Encryptions
* Initial encryption idea is to generate a cipher randomly and uniquely for each website
  * Seed with an RNG
  * Each website has its own seed, as well
  * Encryption combines bytes from RNG + from website seed
  * Decryption does reverse operation (remove RNG seed to get website seed)
* The issue is securely exchanging this RNG key
* Diffie-Hellman key exchange relies on an easy one-way operation but where reversing the operation is hard
* Website generates private key (K1)
* Client / browser generates private key (K2)
* Compute public keys and share with each other
* Combine individual private keys with published public keys - this combined key is now a “shared secret”
* Works because the secret generated by `K1 operation P2` can be used to decrypt messages encrypted by `K2 operation P1`, and vice-versa

## Compromise vectors
* When sending each other public keys, someone swaps our view of the other party’s public key with their public key
  * Then they can see our messages
* Someone replaces encrypted text with some text that decrypts into an undesired message / response
  * Bank sends message asking to move funds
  * Someone replace response with yes to no

## Data Authenticity
* Hash combined encrypted message + shared secret key and send with message as a checksum
* Since the shared secret key cannot be computed by the man-in-the-middle...
  * Even if they could replace the encrypted message with their own message...
  * This encrypted message would not match the hashed checksum, which includes this shared secret key

## Certificates
* Private key + message produces a signature
* Public key + message + signature produces an answer as to whether the signature was produced by the private key associated with the public key
* A trusted third-paty “Root”
* "Root" keeps track of public/private key pairs
* I / client only trust messages signed by "Root"
* Servers get their public key + website name signed by "Root" and passes that signature along during Key Exchange
* A man-in-the middle would need to get "Root" to sign their malicious public key + same website name
* public key + website name = Certificates
